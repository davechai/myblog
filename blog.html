<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Blog</title>
		<link rel="stylesheet" type="text/css" href="css/reset.css"/>
		<link rel="stylesheet" type="text/css" href="css/base.css"/>
		<link rel="stylesheet" type="text/css" href="css/index.css"/>
		<script type="text/javascript" src="js/jquery-3.2.1.js"></script>
		<style>
			#content>form>h2 {
				color: black;
			}
			#content>form>input {
				width: 300px;
				height: 30px;
				margin: 10px 0;
			}
		</style>
	</head>
	<body>
	  <!--容器-->
	  <div id="wrapper">
	    <!--头部-->
	    <header>
	      <div class="top">
	        <div class="logo fl">这一切没有想象的那么遭</div>
	        <!--搜索框-->
	        <div class="search fr">
	        	<form action="#" method="post" id="search-form">
	        		<input type="text" id="keyword" class="input" placeholder="请输入关键字"/>
	        		<input type="submit" class="submit" value="搜索"/>
	        	</form>
	        </div>
	        <!--清除浮动-->
	        <div class="clear"></div>
	        <!--导航-->
	        <nav>
	          <div class="nav">
	          	<ul class="menu">
	          		<li><a href="javascript:;" onclick="chgPage('home')">首页</a></li>
                <li><a href="javascript:;" onclick="chgPage('article')">技术文章</a></li>
                <li><a href="javascript:;" onclick="chgPage('note')">读书笔记</a></li>
                <li><a href="javascript:;" onclick="chgPage('about')">个人简介</a></li>
                <li><a href="javascript:;" onclick="chgPage('message')">给我留言</a></li>
	          	</ul>
	          	<div class="theme fr">
	          	  <span id="theme-span">主题切换</span>
                <select id="sel">
                  <option value="0">蘇芳</option>
                  <option value="1">枯草</option>
                  <option value="2">石竹</option>
                  <option value="3">錆青磁</option>
                  <option value="4">鳩羽紫</option>
                  <option value="5">遠洲鼠</option>
                  <option value="6">柳煤竹茶</option>
                  <option value="7">落栗</option>
                </select>
              </div>
	          </div>
	        </nav>
	      </div>
	    </header>
	    <!--主体内容-->
	    <section id="content">
				<form action="#" method="post">
            <h2>文章标题</h2><input type="text" id="title" name="title"><br/>
            <h2>文章作者</h2><input type="text" id="author" name="author"><br/>
						<h2>文章一级分类</h2>
						<select name="type" id="type1" style="width: 300px;height: 40px;margin: 10px 0;">
						</select>
							<!-- <input type="radio" id="type1" name="type1" value="TEC">TEC
							<input type="radio" id="type2" name="type2" value="NOTE">NOTE -->
						<br/>
						<h2>文章二级分类</h2>
						<select name="type" id="type2" style="width: 300px;height: 40px;margin: 10px 0;">
						</select>
						<h2>文章描述</h2>
						<textarea id="des" rows='10' cols='100' name="des"></textarea>
						<h2>文章内容</h2>
            <script id="container" name="content" type="text/plain"></script>
            <!-- 配置文件 -->
            <script type="text/javascript" src="ueditor.config.js"></script>
            <!-- 编辑器源码文件 -->
            <script type="text/javascript" src="ueditor.all.js"></script>
            <!-- 实例化编辑器 -->
            <script type="text/javascript">
                var ue = UE.getEditor('container',{
                    autoHeightEnabled: true,
                    autoFloatEnabled: true,
										initialFrameHeight:600,
										initialFrameWidth:960
								});
            </script>
						<input type="button" id="btn" value="提交"/>
					</form>
	    </section>
	    <!--页底-->
	    
	  <footer>
        <div class="copyright">
          <p>&copy;2017 版权所有:这一切没有想象的那么遭 备案号：甘ICP备19930601号</p>
        </div>
      </footer>
		</div>
		<script>
			var type1LS=type2LS=null;

			//根据文章一级分类显示对应的文章二级分类
			function type1Chg(typeData1){
				let html = '';
				for(let item of type2LS){
					if(item.art_type1 == typeData1)
						html += `<option value='${item.art_type2}'>${item.art_type2_des}</option>`
				}
				$('#type2').html(html);
			}

			//获取文章分类（一级分类&二级分类）
			function getType(){
				$.ajax({
					type:'get',
					url:'http://127.0.0.1/myblog-wysiwyg/data/blog/getType.php',
					success:function(res){
					  type1LS = res.type1;
						type2LS = res.type2;
						let html='';
						for(let item of type1LS){
							html += `<option value='${item.art_type1}'>${item.art_type1_des}</option>`
						}
						$('#type1').html(html);
					}
				}).then(function(){
					let typeData1 = $('#type1').val();
					type1Chg(typeData1);
				})
			}
			//点选文章一级分类显示对应的文章二级分类
			$('#type1').change(function(){
				let typeData1 = $('#type1').val();
				type1Chg(typeData1);
			});

			//页面初始化-获取文章一级&二级分类
			$(function(){
				getType();
			});
		
			//提交文章
			$('#btn').click(function(){
				var title = $("#title").val();
				var author = $('#author').val();
				var des = $('#des').val();
				var type1 = $('#type1').val();
				var type2 = $('#type2').val();
				var content = ue.getContent();
				$.ajax({
					type:'post',
					url:'http://127.0.0.1/myblog-wysiwyg/data/article/addArticle.php',
					data:{
						title:title,
						author:author,
						des:des,
						type1:type1,
						type2:type2,
						content:content
					},
					success:(res) => {
						if(res.code == 200) {
							console.log('添加成功');
						} else {
							console.log('添加失败');
						}
					},
					error:(err) => {
						console.log(err);
					}
				})
			});

		</script>
	</body>

</html>








